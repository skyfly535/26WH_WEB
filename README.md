# Развертывание веб приложения. Динамический веб.

Задание:

-  развернуть стенд при помощи Ansible nginx + php-fpm (wordpress) + python (django) + js(node.js);

- настройка окружения в docker-compose;

- деплой через docker-compose.

Цель:

Получить практические навыки в настройке инфраструктуры с помощью манифестов и конфигураций. Отточить навыки использования ansible/vagrant/docker.

## Развертывание стенда с инфраструктурой для веб приложения.

Стэнд состоит из хостовой машины под управлением ОС Ubuntu 20.04 на которой развернут Ansible и виртуальной машины `bento/ubuntu-20.04`.

Виртуальная машина с именем: `DynamicWeb` выполняет роль сервера веб приложения.

Разворачиваем инфраструктуру в Vagrant исключительно через Ansible, а настройку окружения прозводим контейнерами необходимых сервисов в docker-compose.

Все коментарии по каждому блоку указаны в тексте Playbook - `web.yml`.

Все коментарии по настройке окружения в docker-compose указаны в тексте `docker-compose.yml`.

Каталог `project` необходимо поместить в каталог с Playbook `web.yml` и Vagranfile.

Выполняем установку стенда:

```
vagrant up
```
После завершения развертывания сервера веб приложения,заходим на сервер 

```
vagrant ssh DynamicWeb
```
и выполняем команду
```
vagrant@DynamicWeb:~/project$ docker stats
```
и смотрим на состояние контейнеров
```
CONTAINER ID   NAME        CPU %     MEM USAGE / LIMIT     MEM %     NET I/O           BLOCK I/O        PIDS
908e42c2f2da   nginx       0.00%     2.781MiB / 1.937GiB   0.14%     236kB / 2.27MB    221kB / 0B       2
64bcadf458f4   wordpress   0.01%     56.18MiB / 1.937GiB   2.83%     802kB / 147kB     151MB / 1.41MB   3
a9097369eb68   node        0.00%     7.555MiB / 1.937GiB   0.38%     8.92kB / 2.93kB   238kB / 0B       7
e2bd4464317b   database    1.26%     432.5MiB / 1.937GiB   21.81%    82.4kB / 73.5kB   200MB / 501MB    39
2df8436eaa44   app         0.05%     68.05MiB / 1.937GiB   3.43%     12kB / 64.3kB     5.1MB / 90.1kB   3
```
## Проверяем работу стенда

На хостовой машине поочередно обращаемся к назначенным портам.

На http://127.0.0.1:8081/ нам отвечает `django`



На http://127.0.0.1:8082/ нам отвечает `node.js`



На http://127.0.0.1:8082/ нам отвечает `wordpress`